{"ast":null,"code":"var _jsxFileName = \"/Users/rubyzli/Desktop/employee-exercise/client/src/Pages/EmployeeList.jsx\",\n  _s = $RefreshSig$();\nimport { useEffect, useState } from \"react\";\nimport Loading from \"../Components/Loading\";\nimport EmployeeTable from \"../Components/EmployeeTable\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst fetchEmployees = signal => {\n  return fetch(\"/api/employees\", {\n    signal\n  }).then(res => res.json());\n};\nconst fetchEmployeesByLevel = query => {\n  return fetch(`/api/employees/level/search?search=${query}`, {}).then(res => res.json());\n};\nconst fetchEmployeesByPosition = query => {\n  return fetch(`/api/employees/position/search?search=${query}`, {}).then(res => res.json());\n};\nconst deleteEmployee = id => {\n  return fetch(`/api/employees/${id}`, {\n    method: \"DELETE\"\n  }).then(res => res.json());\n};\nconst updateEmployee = employee => {\n  return fetch(`/api/employees/${employee._id}`, {\n    method: \"PATCH\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify(employee)\n  }).then(res => res.json());\n};\nconst EmployeeList = () => {\n  _s();\n  const [loading, setLoading] = useState(true);\n  const [data, setData] = useState(null);\n  const handleDelete = id => {\n    deleteEmployee(id).catch(err => {\n      console.log(err);\n    });\n    setData(employees => {\n      return employees.filter(employee => employee._id !== id);\n    });\n  };\n  const sortLevel = e => {\n    fetchEmployeesByLevel(e.target.value).then(data => {\n      setData(data);\n    }).catch(err => {\n      throw err;\n    });\n  };\n  const sortPosition = e => {\n    fetchEmployeesByPosition(e.target.value).then(data => {\n      setData(data);\n    }).catch(err => {\n      throw err;\n    });\n  };\n  useEffect(() => {\n    const controller = new AbortController();\n    fetchEmployees(controller.signal).then(employees => {\n      setLoading(false);\n      setData(employees);\n    }).catch(error => {\n      if (error.name !== \"AbortError\") {\n        setData(null);\n        throw error;\n      }\n    });\n    return () => controller.abort();\n  }, []);\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(EmployeeTable, {\n    employees: data,\n    updateEmployee: updateEmployee,\n    onDelete: handleDelete,\n    sortLevel: sortLevel,\n    sortPosition: sortPosition\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 91,\n    columnNumber: 10\n  }, this);\n};\n_s(EmployeeList, \"EqmXxTNe6/Onm1/o8y2B4tS3LuE=\");\n_c = EmployeeList;\nexport default EmployeeList;\nvar _c;\n$RefreshReg$(_c, \"EmployeeList\");","map":{"version":3,"names":["useEffect","useState","Loading","EmployeeTable","fetchEmployees","signal","fetch","then","res","json","fetchEmployeesByLevel","query","fetchEmployeesByPosition","deleteEmployee","id","method","updateEmployee","employee","_id","headers","body","JSON","stringify","EmployeeList","loading","setLoading","data","setData","handleDelete","catch","err","console","log","employees","filter","sortLevel","e","target","value","sortPosition","controller","AbortController","error","name","abort"],"sources":["/Users/rubyzli/Desktop/employee-exercise/client/src/Pages/EmployeeList.jsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport Loading from \"../Components/Loading\";\nimport EmployeeTable from \"../Components/EmployeeTable\";\n\nconst fetchEmployees = (signal) => {\n  return fetch(\"/api/employees\", { signal }).then((res) => res.json());\n};\n\nconst fetchEmployeesByLevel = (query) => {\n  return fetch(`/api/employees/level/search?search=${query}`, {})\n    .then(res => res.json())\n};\n\nconst fetchEmployeesByPosition = (query) => {\n  return fetch(`/api/employees/position/search?search=${query}`, {})\n    .then(res => res.json());\n}\n\nconst deleteEmployee = (id) => {\n  return fetch(`/api/employees/${id}`, { method: \"DELETE\" }).then((res) =>\n    res.json()\n  );\n};\n\nconst updateEmployee = (employee) => {\n  return fetch(`/api/employees/${employee._id}`, {\n    method: \"PATCH\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify(employee),\n  }).then((res) => res.json());\n};\n\nconst EmployeeList = () => {\n  const [loading, setLoading] = useState(true);\n  const [data, setData] = useState(null);\n\n  const handleDelete = (id) => {\n    deleteEmployee(id).catch((err) => {\n      console.log(err);\n    });\n\n    setData((employees) => {\n      return employees.filter((employee) => employee._id !== id);\n    });\n  };\n\n  const sortLevel = (e) => {\n    fetchEmployeesByLevel(e.target.value)\n      .then((data) => {\n        setData(data)\n      })\n      .catch((err) => {\n        throw err;\n      })\n  }\n\n  const sortPosition = (e) => {\n    fetchEmployeesByPosition(e.target.value)\n      .then(data => {\n        setData(data);\n      })\n      .catch(err => {\n        throw err;\n      })\n  }\n  \n  useEffect(() => {\n    const controller = new AbortController();\n\n    fetchEmployees(controller.signal)\n      .then((employees) => {\n        setLoading(false);\n        setData(employees);\n      })\n      .catch((error) => {\n        if (error.name !== \"AbortError\") {\n          setData(null);\n          throw error;\n        }\n      });\n\n    return () => controller.abort();\n  }, []);\n\n  if (loading) {\n    return <Loading />;\n  }\n\n  return <EmployeeTable  \n          employees={data} \n          updateEmployee={updateEmployee} \n          onDelete={handleDelete} \n          sortLevel={sortLevel}\n          sortPosition={sortPosition}\n        />;\n};\n\nexport default EmployeeList;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}